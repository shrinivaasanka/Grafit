
verhulstpearlreedlaw <- function(filename, lambda, initialcondition)
{
  print(filename)
  layout(matrix(1:3,3,1))
  coronavirus2019dataset <- read.table(filename, header=TRUE)
  #print(coronavirus2019dataset[[2]])
  covid2019df <- data.frame(as.numeric(coronavirus2019dataset[[2]]))
  attach(covid2019df)
  coronavirus2019scaled <- c(as.double(coronavirus2019dataset[[2]]))
  coronavirus2019scaled <- coronavirus2019scaled/max(coronavirus2019scaled)
  #coronavirus2019scaled <- covid2019df[[1]]/max(covid2019df[[1]])
  print("coronavirus2019scaled:")
  print(coronavirus2019scaled)
  covid2019ts <- ts(coronavirus2019scaled)
  ts.plot(covid2019ts)
  vprlogistic <- c()
  maylogistic <- c()
  x1 <- as.double(initialcondition)
  x2 <- as.double(initialcondition)
  for(n in 1:length(coronavirus2019scaled))
  {
    x1next <- as.double(lambda * x1 * (1 - x1))
    vprlogistic <- c(vprlogistic, x1next)
    x2next <- as.double(initialcondition * exp(lambda*(1 - x2)))
    maylogistic <- c(maylogistic,x2next)
    x1 <- x1next
    x2 <- x2next
  }
  print("vprlogistic:")
  print(rev(vprlogistic))
  corrcoeff11 <- cor.test(coronavirus2019scaled,rev(vprlogistic),method="kendall",alternative="greater")
  print(corrcoeff11)
  corrcoeff12 <- cor.test(coronavirus2019scaled,rev(vprlogistic),method="spearman",alternative="greater")
  print(corrcoeff12)
  corrcoeff13 <- cor.test(coronavirus2019scaled,rev(vprlogistic),method="pearson",alternative="greater")
  print(corrcoeff13)
  vprlogisticts <- ts(rev(vprlogistic))
  ts.plot(vprlogisticts)
  print("---------------------------------------------")
  print("maylogistic:")
  print(rev(maylogistic))
  corrcoeff21 <- cor.test(coronavirus2019scaled,(maylogistic),method="kendall",alternative="greater")
  print(corrcoeff21)
  corrcoeff22 <- cor.test(coronavirus2019scaled,(maylogistic),method="spearman",alternative="greater")
  print(corrcoeff22)
  corrcoeff23 <- cor.test(coronavirus2019scaled,(maylogistic),method="pearson",alternative="greater")
  print(corrcoeff23)
  maylogisticts <- ts(maylogistic)
  ts.plot(maylogisticts)
  print("---------------------------------------------")
  print("vprlogistic factors:")
  print(factor(vprlogistic))
  print("maylogistic factors:")
  print(factor(maylogistic))
  c(corrcoeff11,corrcoeff12,corrcoeff13)
}
#corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",4.829487535509905,0.00000000000001)
#corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",0.529487535509905,0.00000000000001)
corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",1.079487535509905,0.00000000000001)
#corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",1.129487535509905,0.00000000000001)
#corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",2.529487535509905,0.00000000000001)
#corcoeff <- verhulstpearlreedlaw("./VerhulstPearlReedLogistic.dat",2.479487535509905,0.00000000000001)
print("correlation coefficients:")
print(corcoeff)
